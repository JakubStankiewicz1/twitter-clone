<div class="login-modal">
  <div class="login-header">
    <button class="close-btn" (click)="onClose()" title="Zamknij" aria-label="Zamknij modal">
      <svg viewBox="0 0 24 24" width="20" height="20">
        <path d="M18.36 6.64c.39-.39.39-1.02 0-1.41s-1.02-.39-1.41 0L12 10.18 7.05 5.23c-.39-.39-1.02-.39-1.41 0s-.39 1.02 0 1.41L10.59 12l-4.95 4.95c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.95 4.95c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.95-4.95z" fill="currentColor"/>
      </svg>
    </button>
    <div class="logo">
      <svg viewBox="0 0 24 24" width="30" height="30">
        <path d="M23.643 4.937c-.835.37-1.732.62-2.675.733.962-.576 1.7-1.49 2.048-2.578-.9.534-1.897.922-2.958 1.13-.85-.904-2.06-1.47-3.4-1.47-2.572 0-4.658 2.086-4.658 4.66 0 .364.042.718.12 1.06-3.873-.195-7.304-2.05-9.602-4.868-.4.69-.63 1.49-.63 2.342 0 1.616.823 3.043 2.072 3.878-.764-.025-1.482-.234-2.11-.583v.06c0 2.257 1.605 4.14 3.737 4.568-.392.106-.803.162-1.227.162-.3 0-.593-.028-.877-.082.593 1.85 2.313 3.198 4.352 3.234-1.595 1.25-3.604 1.995-5.786 1.995-.376 0-.747-.022-1.112-.065 2.062 1.323 4.51 2.093 7.14 2.093 8.57 0 13.255-7.098 13.255-13.254 0-.2-.005-.402-.014-.602.91-.658 1.7-1.477 2.323-2.41z" fill="currentColor"/>
      </svg>
    </div>
  </div>

  <div class="login-content">
    <h1>Zaloguj się do serwisu X</h1>

    <!-- Komunikat błędu -->
    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
    </div>
    
    <!-- KROK 1: Social login i email/username -->
    <div *ngIf="currentStep === 1">
      <!-- Social Login Buttons -->
      <div class="social-login">
        <button class="social-btn google-btn" type="button" aria-label="Zaloguj się przez Google">
          <img src="assets/landing/google_icon.png" alt="Google" width="18" height="18">
          <span>Zaloguj się przez Google</span>
        </button>
        
        <button class="social-btn apple-btn" type="button" aria-label="Zaloguj się przez Apple">
          <img src="assets/landing/apple_icon.png" alt="Apple" width="18" height="18">
          <span>Zaloguj się przez Apple</span>
        </button>
      </div>

      <!-- Divider -->
      <div class="divider">
        <span>lub</span>
      </div>
      
      <!-- Email/Username Form -->
      <form class="login-form" (ngSubmit)="nextStep()">
        <div class="form-group">
          <div class="input-wrapper">
            <input 
              type="text" 
              id="identifier" 
              [(ngModel)]="formData.identifier" 
              name="identifier"
              required
              [class.filled]="formData.identifier"
              placeholder=" "
              aria-label="Telefon, e-mail lub nazwa użytkownika"
            />
            <label for="identifier">Telefon, e-mail lub nazwa użytkownika</label>
          </div>
        </div>
        
        <button 
          type="submit" 
          class="next-btn"
          [class.disabled]="!formData.identifier.trim()"
          [disabled]="!formData.identifier.trim()">
          Dalej
        </button>
      </form>

      <!-- Sign up link -->
      <div class="signup-section">
        <span>Nie masz konta? </span>
        <a href="#" (click)="onSignUpClick($event)" class="signup-link">Zarejestruj się</a>
      </div>
    </div>

    <!-- KROK 2: Hasło -->
    <div *ngIf="currentStep === 2">
      <!-- User identifier display -->
      <div class="user-info">
        <p>Logowanie do <strong>{{ formData.identifier }}</strong></p>
        <button type="button" class="change-user" (click)="prevStep()">Zmień konto</button>
      </div>

      <!-- Password Form -->
      <form class="login-form" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <div class="input-wrapper">
            <input 
              type="password" 
              id="password" 
              [(ngModel)]="formData.password" 
              name="password"
              required
              [class.filled]="formData.password"
              placeholder=" "
              minlength="6"
              aria-label="Hasło"
            />
            <label for="password">Hasło</label>
          </div>
        </div>
        
        <button 
          type="submit" 
          class="login-btn"
          [class.disabled]="!isFormValid() || isLoading"
          [disabled]="!isFormValid() || isLoading">
          <span *ngIf="!isLoading">Zaloguj się</span>
          <span *ngIf="isLoading">Logowanie...</span>
        </button>
      </form>

      <!-- Forgot password link -->
      <div class="forgot-password">
        <a href="#" class="forgot-link">Nie pamiętasz hasła?</a>
      </div>
    </div>
  </div>
</div>
